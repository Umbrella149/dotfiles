# ================================================================
# 1. 基础全局设置
# ================================================================
# 注意：删掉之前写在第一行的 run tpm！

set -g mouse on
set -s escape-time 0
set -g base-index 1
setw -g pane-base-index 1
set -g renumber-windows on
set -g status-interval 1
set -g status-position top        # 既然你用 LazyVim，状态栏放上面可能更习惯

set -g default-terminal "xterm-256color"
set -ga terminal-overrides ",xterm-256color:Tc"

# ================================================================
# 2. 前缀键设置 (Prefix)
# ================================================================
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# ================================================================
# 3. 插件定义 (必须在 run tpm 之前)
# ================================================================
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'aserowy/tmux.nvim'
set -g @plugin 'MunifTanjim/tmux-mode-indicator'
set -g @plugin 'catppuccin/tmux'

# --- 模式显示配置 (Mode Indicator) ---
set -g @mode_indicator_prefix_prompt ' WAIT '
set -g @mode_indicator_copy_prompt   ' COPY '
set -g @mode_indicator_sync_prompt   ' SYNC '
set -g @mode_indicator_empty_prompt  ' TMUX '
set -g @mode_indicator_prefix_mode_style 'bg=#fe8019,fg=#1d2021,bold'
set -g @mode_indicator_copy_mode_style   'bg=#fabd2f,fg=#1d2021,bold'

# --- Catppuccin 主题配置 (关键：整合 mode-indicator) ---
set -g @catppuccin_flavour 'mocha'
set -g @catppuccin_window_status_enable "yes"
set -g @catppuccin_window_status_icon_enable "yes"
# 强制把 mode_indicator 注入到右侧状态栏
set -g @catppuccin_status_modules_right "application session mode_indicator date_time"

# --- nvim 导航配置 ---
set -g @tmux-nvim-navigation true
set -g @tmux-nvim-navigation-keybinding-left 'C-h'
set -g @tmux-nvim-navigation-keybinding-down 'C-j'
set -g @tmux-nvim-navigation-keybinding-up 'C-k'
set -g @tmux-nvim-navigation-keybinding-right 'C-l'

# ================================================================
# 4. 键位映射 (LazyVim 风格)
# ================================================================
bind-key w switch-client -T window-map

# [基础管理]
bind-key -T window-map s split-window -v -c "#{pane_current_path}"
bind-key -T window-map v split-window -h -c "#{pane_current_path}"
bind-key -T window-map d kill-pane
bind-key -T window-map m resize-pane -Z

# [移动焦点]
bind-key -T window-map h select-pane -L
bind-key -T window-map j select-pane -D
bind-key -T window-map k select-pane -U
bind-key -T window-map l select-pane -R

# [移动位置]
bind-key -T window-map H run-shell 'tmux select-pane -m; tmux select-pane -L; tmux swap-pane; tmux select-pane -L; tmux select-pane -M'
bind-key -T window-map J run-shell 'tmux select-pane -m; tmux select-pane -D; tmux swap-pane; tmux select-pane -D; tmux select-pane -M'
bind-key -T window-map K run-shell 'tmux select-pane -m; tmux select-pane -U; tmux swap-pane; tmux select-pane -U; tmux select-pane -M'
bind-key -T window-map L run-shell 'tmux select-pane -m; tmux select-pane -R; tmux swap-pane; tmux select-pane -R; tmux select-pane -M'

# 全局快捷键
bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

# ================================================================
# 5. 初始化 TPM (必须放在最后，且仅此一行)
# ================================================================
run '~/.tmux/plugins/tpm/tpm'
